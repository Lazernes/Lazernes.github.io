---
title: "3장 케라스와 텐서플로 소개"
excerpt: "텐서플로, 케라스 그리고 둘 간의 관계를 자세히 알아본다."

wirter: Myeongwoo Yoon
categories:
  - Deep Learning with Python
tags:
  - Deep Learning
  - Python

toc: true
toc_sticky: true
use_math: true
 
date: 2024-11-07
last_modified_at: 2024-11-07
---

텐서플로란?
======

&ensp;**텐서플로(TensorFlow)**는 구글에서 만든 파이썬 기반의 무료 오픈 소스 머신 러닝 플랫폼이다. 넘파이(Numpy)와 매우 비슷하게 텐서플로의 핵심 목적은 엔지니어와 연구자가 수치 텐서에 대한 수학적 표현을 적용할 수 있도록 하는 것이다. 하지만 텐서플로는 다음과 같이 넘파이의 기능을 넘어선다.
* 미분 가능한 어떤 표현식에 대해서도 자동으로 그레디언트를 계산할수 있으므로 머신 러닝에 매우 적합한다.
* CPU 뿐만 아니라 고도로 병렬화된 하드웨어 가속기인 CPU와 TPU에서도 실행할 수 있다.
* 텐서플로에서 정의한 계산은 여러 머신에 쉽게 분산시킬 수 있다.
* 텐서프로 프로그램은 C++, JS 등과 같은 런타임에 맞게 변환할 수 있다. 따라서 텐서프롤 애플리케이션을 실전 환경에 쉽게 배포할 수 있다.

케라스란?
======

&ensp;케라스는 텐서플로 위에 구축된 파이썬용 딥러닝 API로 어떤 종류의 딥러닝 모델도 쉽게 만들고 훈련할 수 있는 방법을 제공한다. 텐서플로를 통해 케라스는 다양한 하드웨어(CPU, TPU, CPU) 위에 실행하고 수천 대의 머신 러닝으로 매끄럽게 확장할 수 있다.<br/>
<p align="center"><img src="/assets/img/Deep Learning with Python/3장 케라스와 텐서플로 소개/2-1-케라스와 텐서플로.png" width="300"></p>

&ensp;케라스는 개발자 경험을 중요하게 생각한다. 일관되고 간단한 워크플로를 제공하며, 일반적인 사용에 필요한 작업의 횟수를 최소화하고, 사용자 에러에 대해 명확하고 실행 가능한피드백을 제공한다. 케라스의 사용자 층이 크고 다양하기 때문에 모델을 구축하고 훈련하는 데 하나의 표준 방식을 따르도록 강요하지 않는다. 사용자 성향에 따라 고수준에서 저수준까지 다양한 워크플로를 사용할 수 있다.

텐서플로 시작하기
======

&ensp;신경망 훈련은 다음과 같은 개념을 중심으로 진행된다.
* 모든 현대적인 머신 러닝의 기초 인프라가 되는 저수준 텐서 연산
  - **텐서**(신경망의 상태를 저장하는 특별한 텐서(변수)도 포함)
  - 덧셈, relu, matmul 같은 **텐서 연산**
  - **역전파**
* 고수준 딥러닝 개념
  - **모델**을 구성하는 **층**
  - 학습에 사용하는 피드백 신호를 정의하는 **손실 함수**
  - 학습 진행 방법을 결정하는 **옵티마이저**
  - 정확도처럼 모델의 성능을 평가하는 **측정 지표**
  - 미니 배치를 확률적 경사 하강법을 수행하는 **훈련 루프**

상수 텐서와 변수
------

&ensp;텐서플로에서 어떤 작업을 하려면 텐서가 필요하다. 텐서를 만들려면 초깃값이 필요하다. 예를 들어 모두 1이거나 0인 텐서를 만들거나, 랜덤한 분포에서 뽑은 값으로 텐서를 만들 수 있다.<br/>
<p align="center"><img src="/assets/img/Deep Learning with Python/3장 케라스와 텐서플로 소개/3-1-모두 1또는 0인 테서, 랜덤 텐서.png" width="400"></p>

&ensp;넘파이 배열과 텐서플로 텐서 사이의 큰 차이점은 텐서플로 텐서에는 값을 할당할 수 없다는 것이다. 즉, 텐서플로 텐서는 상수이다. 예를 들어 넘파이에서 다음과 같이 할 수 있다.
```python
import numpy as np

x = np.ones(shape=(2, 2))
x[0, 0] =0.
```

&ensp;텐서플로에서 같은 작업을 하면 "EagerTensor object does not support item assignment"와 같은 에러가 발생한다.
```python
x = tf.ones(shape=(2, 2))
x[0, 0] = 0.  # 텐서에는 값을 할당할 수 없기 때문에 에러가 발생
```

&ensp;모델을 훈련하려면 모델의 상태, 즉 일련의 텐서를 업데이트해야 한다.

신경망의 구조: 핵심 Keras API 이해하기
======