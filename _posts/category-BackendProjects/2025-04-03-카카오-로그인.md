---
title: "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸"
excerpt: "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ìœ„í•œ ë°±ì—”ë“œ êµ¬í˜„"

wirter: Myeongwoo Yoon
categories:
  - BackendProjects
tags:
  - Java
  - SpringBoot
  - ì„œìš¸ì‹œê³µê³µë°ì´í„°ì°½ì—…ê²½ì§„ëŒ€íšŒ

toc: true
toc_sticky: true
use_math: true
 
date: 2025-04-03
last_modified_at: 2025-04-03
---

&ensp;ë‹¤ìŒì€ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ìœ„í•œ ë¬¸ì„œì´ë‹¤.<br/>
https://developers.kakao.com/docs/latest/ko/kakaologin/common <br/>

&ensp;ë‹¤ìŒì€ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ê³¼ì •ì´ë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/0-1-kakaologin sequence.png"></p>

* ì¸ê°€ ì½”ë“œ ë°›ê¸°
  - ì„œë¹„ìŠ¤ ì„œë²„ê°€ ì¹´ì¹´ì˜¤ ì¸ì¦ ì„œë²„ë¡œ ì¸ê°€ ì½”ë“œ ë°›ê¸°ë¥¼ ìš”ì²­í•œë‹¤.
  - ì¹´ì¹´ì˜¤ ì¸ì¦ ì„œë²„ê°€ ì‚¬ìš©ìì—ì„œ ì¸ì¦ì„ ìš”ì²­í•œë‹¤.
  - ì‚¬ìš©ìê°€ ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•œë‹¤.
  - ì¹´ì¹´ì˜¤ ì¸ì¦ ì„œë²„ê°€ ì‚¬ìš©ìì—ê²Œ ë™ì˜ í™”ë©´ì„ ì¶œë ¥í•˜ì—¬ ì¸ê°€ë¥¼ ìœ„í•œ ì‚¬ìš©ì ë™ì˜ë¥¼ ìš”ì²­í•œë‹¤.
  - ì‚¬ìš©ìê°€ í•„ìˆ˜ ë™ì˜í•­ëª©ê³¼, ì´ ì™¸ì˜ ì›í•˜ëŠ” ë™ì˜í•­ëª©ì— ë™ì˜í•œ ë’¤ "ë™ì˜í•˜ê³  ê³„ì†í•˜ê¸°" ë²„íŠ¼ì„ ëˆ„ë¥¸ë‹¤.
  - ì¹´ì¹´ì˜¤ ì¸ì¦ ì„œë²„ëŠ” ì„œë¹„ìŠ¤ ì„œë²„ì˜ Redirect URIë¡œ ì¸ê°€ ì½”ë“œë¥¼ ì „ë‹¬í•œë‹¤.
* í† í° ë°›ê¸°
  - ì„œë¹„ìŠ¤ ì„œë²„ê°€ Redirect URIë¡œ ì „ë‹¬ë°›ì€ ì¸ê°€ ì½”ë“œë¡œ í† í° ë°›ê¸°ë¥¼ ìš”ì²­í•œë‹¤.
  - ì¹´ì¹´ì˜¤ ì¸ì¦ ì„œë²„ê°€ í† í°ì„ ë°œê¸‰í•´ ì„œë¹„ìŠ¤ ì„œë²„ì— ì „ë‹¬í•œë‹¤.
* ì‚¬ìš©ì ë¡œê·¸ì¸ ì²˜ë¦¬
  - ì„œë¹„ìŠ¤ ì„œë²„ê°€ ë°œê¸‰ë°›ì€ ì—‘ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°ë¥¼ ìš”ì²­í•´ ì‚¬ìš©ìì˜ íšŒì›ë²ˆí˜¸ ë° ì •ë³´ë¥¼ ì¡°íšŒí•˜ì—¬ ì„œë¹„ìŠ¤ íšŒì›ì¸ì§€ í™•ì¸í•œë‹¤.
  - ì„œë¹„ìŠ¤ íšŒì› ì •ë³´ í™•ì¸ ê²°ê³¼ì— ë”°ë¼ ì„œë¹„ìŠ¤ ë¡œê·¸ì¸ ë˜ëŠ” íšŒì› ê°€ì…í•œë‹¤.
  - ì´ ì™¸ ì„œë¹„ìŠ¤ì—ì„œ í•„ìš”í•œ ë¡œê·¸ì¸ ì ˆì°¨ë¥¼ ìˆ˜í–‰í•œ í›„, ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì„œë¹„ìŠ¤ ë¡œê·¸ì¸ ì²˜ë¦¬ë¥¼ ì™„ë£Œí•œë‹¤.

Kakao Developer Setting
======

&ensp;ê°œë°œí•˜ê¸° ì „, Kakao Develoer(https://developers.kakao.com/)ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤.<br/> 
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/1-1-Kakao Developer Setting Add Project.png"></p>

&ensp;ì´í›„ ë„ë©”ì¸ì„ ì¶”ê°€í•˜ê³  ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ í™œì„±í™”í•´ì¤€ë’¤, Redirect URIë¥¼ ì„¤ì •í•´ì¤€ë‹¤..<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/1-2-Kakao Developer Setting Add Domain.png"></p>

<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/1-3-Kakao Developer Setting Activate Kakao login.png"></p>

<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/1-4-Kakao Developer Setting Add Redirect URI.png"></p>

ë™ì˜ í•­ëª© ì„¤ì •
------

&ensp;ì‚¬ìš©ì ì •ë³´ë¥¼ ìš”ì²­í•˜ê¸° ìœ„í•´ ë™ì˜ í•­ëª©ì„ ì„¤ì •í•´ì¤€ë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/1-5-Kakao Developer Setting Agree Setting.png"></p>

* í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë‹‰ë„¤ì„ì€ ë¡œê·¸ì¸ ì´í›„ì— ë°›ì„ ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— í”„ë¡œí•„ ì‚¬ì§„ë§Œ **í•„ìˆ˜ ë™ì˜** ìƒíƒœë¡œ ë°”ê¿”ì¤€ë‹¤.

ë¡œê·¸ì¸ ìš”ì²­
======

&ensp;ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ Rest API ë¬¸ì„œë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ìš”ì²­ì„ í•˜ë©´ ì¸ê°€ ì½”ë“œë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.
```
https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}
```

* REDIRECT_URI: Kakao Developer Settingì—ì„œ ì„¤ì •í•œ http://localhost:8080/auth/login/kakao
* REST_API_KEY: ì•± ì„¤ì •ì˜ ì•± í‚¤ì—ì„œ í™•ì¸ ê°€ëŠ¥

&ensp;**https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=${REST_API_KEY}&redirect_uri=http://localhost:8080/auth/login/kakao**ë¡œ ì ‘ì†í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/3-2-loginPage2.png"></p>

<!-- SpringSecurity
------

&ensp;Spring Securityë¥¼ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì—ì„œ OAuth ì½œë°± URLì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” í•´ë‹¹ URLì— ëŒ€í•œ ì¸ì¦ì„ ìš°íšŒí•´ì•¼ í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.global.auth.constant;

public class SecurityConstants {

    public static final String[] allowUrls = {
            "/auth/login/kakao/**"
    }; 
}
```

&ensp;SecurityConfigë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.global.auth.config;

import com.example.seoulpublicdata2025backend.global.auth.constant.SecurityConstants;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private static final String[] ALLOWED_URLS = SecurityConstants.allowUrls;

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
                .authorizeHttpRequests(authorizeRequests ->
                        authorizeRequests
                                .requestMatchers(ALLOWED_URLS).permitAll()  // í—ˆìš© URL ì„¤ì •
                                .anyRequest().authenticated()   // ê·¸ ì™¸ ëª¨ë“  ìš”ì²­ì€ ì¸ì¦ í•„ìš”
                )
                .csrf((csrfConfig) ->
                        csrfConfig.disable())   // CSRF ë³´í˜¸ ë¹„í™œì„±í™”
                .formLogin((formLogin) ->
                        formLogin.disable())    // í¼ ë¡œê·¸ì¸ ë¹„í™œì„±í™”
                .httpBasic((httpBasic) ->
                        httpBasic.disable());   // HTTP Basic ì¸ì¦ ë¹„í™œì„±í™”

        return http.build();
    }

}
``` -->

KakaoLoginPageController
------

&ensp;ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ë°˜í™˜í•´ì¤„ kakaoLoginPageController.javaë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/login")
public class KakaoLoginPageController {

    @Value("${kakao.auth.client}")
    private String client_id;

    @Value("${kakao.auth.redirect}")
    private String redirect_uri;

    @GetMapping("/page")
    public String loginPage(Model model) {
        String location = "https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=" + client_id + "redirect_uri=" + redirect_uri;
        model.addAttribute("location", location);

        return "login";
    }
}
```

&ensp;Thymeleaf ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì¤€ ë’¤, resources/templatesì— login.htmlì„ ì‘ì„±í•œë‹¤. ì´ë•Œ thymeleafëŠ” resouces/templatesì— ìˆëŠ” html íŒŒì¼ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ë””ë ‰í† ë¦¬ì— ë„£ì–´ë‘ì–´ì„œëŠ” ì•ˆëœë‹¤.
```html
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>KakaoLogin</title>
</head>
<body>
<div class="container" style="display: flex; justify-content: center; align-content: center; align-items: center; flex-direction: column; margin: 200px auto;">
    <h1>ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸</h1>
    <a th:href="${location}">
        <img src="/assets/kakao_login_medium_narrow.png">
    </a>
</div>

</body>
</html>
```

&ensp;**localhost:8080/login/page**ì— ì ‘ì†í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ì¶œë ¥ëœë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/3-1-loginPage.png"></p>

&ensp;ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ í´ë¦­í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ì¶œë ¥ë˜ê³ , ë¡œê·¸ì¸ì„ í•˜ë©´ ë“±ë¡í•´ë‘” Redirect URIì— íŒŒë¼ë¯¸í„°ë¡œ codeì™€ í•¨ê»˜ Redirectë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/3-2-loginPage2.png"></p>

* http://localhost:8080/auth/login/kakao?code=TGBJ5W5an5fiZkpj37mtaNmD2rXZdK2-XTuWz4jfJNvF46TKQMSR5QAAAAQKFxDvAAABlf-6buBSGUcvaFb1Eg



<!-- AuthController
------

&ensp;Redirect_URIë¥¼ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ë³¸ë‹¤. ì¼ë‹¨, ì•±ì— ë“±ë¡ëœ Redirect URIì— ì „ë‹¬ëœ codeë¥¼ ì „ë‹¬ë°›ì•„ì•¼ í•œë‹¤.<br/>
&ensp;Kakao developerì˜ ë¬¸ì„œë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ headerì™€ bodyë¥¼ ê°€ì§€ê³  ìš”ì²­í•˜ë¼ê³  ë˜ì–´ ìˆë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/2-1-Get Token Basic Information.png"></p>

<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/2-2-Get Token Request Parm.png"></p>

&ensp;ë¨¼ì € clientIdëŠ” ìœ ì¶œë˜ë©´ ì•ˆë˜ê¸° ë•Œë¬¸ì— application.propertiesì— ì €ì¥í•´ë‘”ë‹¤. ì´í›„ KakaoUtil.javaë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.util;

import org.springframework.beans.factory.annotation.Value;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;

@Component
@Slf4j
public class KakaoUtil {

    @Value("${kakao.auth.client}")
    private String client;

    @Value("${kakao.auth.redirect}")
    private String redirect;
}
```

&ensp;ì´ì œ AuthControllerë¥¼ êµ¬í˜„í•´ë³¸ë‹¤.
```java

``` -->

Redirect URIì™€ ê°™ì´ code ì „ë‹¬ë°›ê¸°
======

&ensp;ì´ì œ Redirectëœ URIì— ì „ë‹¬ëœ codeë¥¼ ê°€ì ¸ì™€ë³¸ë‹¤.

KakaoLoginController
------

&ensp;ë¨¼ì € KakaoLoginControllerë¥¼ ëŒ€ëµ ì‘ì„±í•´ë³¸ë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.controller;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@Slf4j
@RestController
@RequiredArgsConstructor
@RequestMapping("")
public class KakaoLoginController {

    @GetMapping("/auth/login/kakao")
    public ResponseEntity<?> KakaoLogin(@RequestParam("code") String code) {
        return new ResponseEntity<>(HttpStatus.OK);
    }
}
```

* ë“±ë¡í•´ë‘” URIì— GetMappingì„ í•´ë‘ë©´ íŒŒë¼ë¯¸í„° codeì™€ í•¨ê»˜ ë°›ì„ ìˆ˜ ìˆë‹¤.

codeë¥¼ í†µí•´ í† í° ë°œê¸‰ ìš”ì²­
======

&ensp;ì¹´ì¹´ì˜¤ë¡œë¶€í„° ë°›ì€ codeë¥¼ ì¹´ì¹´ì˜¤ì— í† í° ë°œê¸‰ ìš”ì²­ì„ í•˜ë©´, ì‚¬ìš©ì ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” í† í°ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/5-1-Kakao Developer Get Token.png"></p>

* https://kauth.kakao.com/oauth/token ìœ¼ë¡œ POST ìš”ì²­ì„ ë³´ë‚´ë©´, í† í°ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

&ensp;ë”°ë¼ì„œ ì¹´ì¹´ì˜¤ë¡œë¶€í„° ë°›ì€ ResponseDTOë¥¼ ìƒì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Getter
@NoArgsConstructor
@JsonIgnoreProperties(ignoreUnknown = true)
public class KakaoTokenResponseDto {

    // ì—­ì§ë ¬í™”ë¥¼ ìœ„í•´ JsonPropertyë¥¼ ì´ìš©
    @JsonProperty("token_type") // í† í° íƒ€ì…
    public String tokenType;
    @JsonProperty("access_token")   // ì‚¬ìš©ì ì—‘ì„¸ìŠ¤ í† í° ê°’
    public String accessToken;
    @JsonProperty("id_token")   // ID í† í° ê°’
    public String idToken;
    @JsonProperty("expires_in") // ì—‘ì„¸ìŠ¤ í† í°ê³¼ ID í† í°ì˜ ë§Œë£Œ ì‹œê°„(ì´ˆ)
    public String expiresIn;
    @JsonProperty("refresh_token")  // ì‚¬ìš©ì ë¦¬í”„ë ˆì‹œ í† í° ê°’
    public String refreshToken;
    @JsonProperty("refresh_token_expires_in")   // ë¦¬í”„ë ˆì‹œ í† í° ë§Œë£Œ ì‹œê°„(ì´ˆ)
    public String refreshTokenExpiresIn;
    @JsonProperty("scope")  // ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì •ë³´ ì¡°íšŒ ê¶Œí•œ ë²”ìœ„
    public String scope;
}
```

KakaoService
------

&ensp;**Spring Reactive Web** dependencyë¥¼ ì¶”ê°€í•´ì¤€ë‹¤. ì´í›„ KakaoServiceë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.service;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto.KakaoTokenResponseDto;
import io.netty.handler.codec.http.HttpHeaderValues;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatusCode;
import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.core.publisher.Mono;

@Slf4j
@RequiredArgsConstructor
@Service
public class KakaoService {

    private String clientId;
    private final String KAUTH_TOKEN_URL_HOST;
    private final String KAUTH_USER_URL_HOST;

    @Autowired
    public KakaoService(@Value("${kakao.auth.client}") String clientId) {
        this.clientId = clientId;
        KAUTH_TOKEN_URL_HOST = "https://kauth.kakao.com";
        KAUTH_USER_URL_HOST = "https://kapi.kakao.com";
    }

    public String getAccessTokenFromKakao(String code) {

        KakaoTokenResponseDto kakaoTokenResponseDto = WebClient.create(KAUTH_TOKEN_URL_HOST).post()
                .uri(uriBuilder -> uriBuilder
                        .scheme("https")
                        .path("/oauth/token")
                        .queryParam("grant_type", "authorization_code")
                        .queryParam("client_id", clientId)
                        .queryParam("code", code)
                        .build(true))
                .header(HttpHeaders.CONTENT_TYPE, HttpHeaderValues.APPLICATION_X_WWW_FORM_URLENCODED.toString())
                .retrieve()
                .onStatus(HttpStatusCode::is4xxClientError, clientResponse -> Mono.error(new RuntimeException("Invalid Parameter")))
                .onStatus(HttpStatusCode::is5xxServerError, clientResponse -> Mono.error(new RuntimeException("Internal Server Error")))
                .bodyToMono(KakaoTokenResponseDto.class)
                .block();

        log.info(" [Kakao Service] Access Token ------> {}", kakaoTokenResponseDto.getAccessToken());
        log.info(" [Kakao Service] Refresh Token ------> {}", kakaoTokenResponseDto.getRefreshToken());
        log.info(" [Kakao Service] Id Token ------> {}", kakaoTokenResponseDto.getIdToken());
        log.info(" [Kakao Service] Scope ------> {}", kakaoTokenResponseDto.getScope());

        return kakaoTokenResponseDto.getAccessToken();
    }

}
```

* Webclientë¡œ HTTP ìš”ì²­ì„ êµ¬í˜„í–ˆë‹¤. ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ Custom Exceptionì´ ìˆë‹¤ë©´ onStatue ë©”ì„œë“œì— ì§€ì •í•˜ë©´ ëœë‹¤.
* HTTP ìš”ì²­ì„ ë°›ì•„ëª¨ë…€ .retrieve() ë©”ì„œë“œ ë¶€í„°, Request Body ë‚´ìš©ì´ ë¯¸ë¦¬ ì§€ì •í•´ë‘” KakaoTokenResponseDtoì— jsonì´ ì§ë ¬í™”ë˜ì–´ ë“¤ì–´ê°€ê²Œ ëœë‹¤.

&ensp;**https://kauth.kakao.com/oauth/token?grant_type=authorizarion_code&client_id=${client_id}&code={code}**ë¡œ Post ìš”ì²­ì„ ë³´ë‚´ë©´, ë°›ì€ Responseì˜ Bodyì— ì•„ë˜ ë‚´ìš©ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.<br/>
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/5-2-Kakao Developer Post request.png"></p>

KakaoLoginController
------

&ensp;ì´ì œ êµ¬í˜„í•œ serviceë¥¼ controllerì—ì„œ ì—°ë™í•œë‹¤. KakaoLoginControllerì— ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤.
```java
@Slf4j
@RestController
@RequiredArgsConstructor
@RequestMapping("")
public class KakaoLoginController {

    private final KakaoService kakaoService;
    
    @GetMapping("/auth/login/kakao")
    public ResponseEntity<?> KakaoLogin(@RequestParam("code") String code) {
        String accessToken = kakaoService.getAccessTokenFromKakao(code);
        return new ResponseEntity<>(HttpStatus.OK);
    }
}
```

* ì´ì œ codeë¥¼ ì´ìš©í•´ì„œ accessTokenì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.

Tokenìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
======

&ensp;ì´ì œ ì¹´ì¹´ì˜¤ì—ì„œ ë°›ì€ access tokenìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì™€ë³¸ë‹¤.

KakaoService
------

&ensp;ë¨¼ì € ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë‹´ì„ KakaoUserInfoResponseDtoë¥¼ ì¶”ê°€í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Getter;
import lombok.NoArgsConstructor;

import java.util.Date;
import java.util.HashMap;

@Getter
@NoArgsConstructor
@JsonIgnoreProperties(ignoreUnknown = true)
public class KakaoUserInfoResponseDto {

    //íšŒì› ë²ˆí˜¸
    @JsonProperty("id")
    public Long id;

    //ìë™ ì—°ê²° ì„¤ì •ì„ ë¹„í™œì„±í™”í•œ ê²½ìš°ë§Œ ì¡´ì¬.
    //true : ì—°ê²° ìƒíƒœ, false : ì—°ê²° ëŒ€ê¸° ìƒíƒœ
    @JsonProperty("has_signed_up")
    public Boolean hasSignedUp;

    //ì„œë¹„ìŠ¤ì— ì—°ê²° ì™„ë£Œëœ ì‹œê°. UTC
    @JsonProperty("connected_at")
    public Date connectedAt;

    //ì¹´ì¹´ì˜¤ì‹±í¬ ê°„í¸ê°€ì…ì„ í†µí•´ ë¡œê·¸ì¸í•œ ì‹œê°. UTC
    @JsonProperty("synched_at")
    public Date synchedAt;

    //ì‚¬ìš©ì í”„ë¡œí¼í‹°
    @JsonProperty("properties")
    public HashMap<String, String> properties;

    //ì¹´ì¹´ì˜¤ ê³„ì • ì •ë³´
    @JsonProperty("kakao_account")
    public KakaoAccount kakaoAccount;

    //uuid ë“± ì¶”ê°€ ì •ë³´
    @JsonProperty("for_partner")
    public Partner partner;

    @Getter
    @NoArgsConstructor
    @JsonIgnoreProperties(ignoreUnknown = true)
    public class KakaoAccount {

        //í”„ë¡œí•„ ì •ë³´ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("profile_needs_agreement")
        public Boolean isProfileAgree;

        //ë‹‰ë„¤ì„ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("profile_nickname_needs_agreement")
        public Boolean isNickNameAgree;

        //í”„ë¡œí•„ ì‚¬ì§„ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("profile_image_needs_agreement")
        public Boolean isProfileImageAgree;

        //ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´
        @JsonProperty("profile")
        public Profile profile;

        //ì´ë¦„ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("name_needs_agreement")
        public Boolean isNameAgree;

        //ì¹´ì¹´ì˜¤ê³„ì • ì´ë¦„
        @JsonProperty("name")
        public String name;

        //ì´ë©”ì¼ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("email_needs_agreement")
        public Boolean isEmailAgree;

        //ì´ë©”ì¼ì´ ìœ íš¨ ì—¬ë¶€
        // true : ìœ íš¨í•œ ì´ë©”ì¼, false : ì´ë©”ì¼ì´ ë‹¤ë¥¸ ì¹´ì¹´ì˜¤ ê³„ì •ì— ì‚¬ìš©ë¼ ë§Œë£Œ
        @JsonProperty("is_email_valid")
        public Boolean isEmailValid;

        //ì´ë©”ì¼ì´ ì¸ì¦ ì—¬ë¶€
        //true : ì¸ì¦ëœ ì´ë©”ì¼, false : ì¸ì¦ë˜ì§€ ì•Šì€ ì´ë©”ì¼
        @JsonProperty("is_email_verified")
        public Boolean isEmailVerified;

        //ì¹´ì¹´ì˜¤ê³„ì • ëŒ€í‘œ ì´ë©”ì¼
        @JsonProperty("email")
        public String email;

        //ì—°ë ¹ëŒ€ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("age_range_needs_agreement")
        public Boolean isAgeAgree;

        //ì—°ë ¹ëŒ€
        //ì°¸ê³  https://developers.kakao.com/docs/latest/ko/kakaologin/rest-api#req-user-info
        @JsonProperty("age_range")
        public String ageRange;

        //ì¶œìƒ ì—°ë„ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("birthyear_needs_agreement")
        public Boolean isBirthYearAgree;

        //ì¶œìƒ ì—°ë„ (YYYY í˜•ì‹)
        @JsonProperty("birthyear")
        public String birthYear;

        //ìƒì¼ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("birthday_needs_agreement")
        public Boolean isBirthDayAgree;

        //ìƒì¼ (MMDD í˜•ì‹)
        @JsonProperty("birthday")
        public String birthDay;

        //ìƒì¼ íƒ€ì…
        // SOLAR(ì–‘ë ¥) í˜¹ì€ LUNAR(ìŒë ¥)
        @JsonProperty("birthday_type")
        public String birthDayType;

        //ì„±ë³„ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("gender_needs_agreement")
        public Boolean isGenderAgree;

        //ì„±ë³„
        @JsonProperty("gender")
        public String gender;

        //ì „í™”ë²ˆí˜¸ ì œê³µ ë™ì˜ ì—¬ë¶€
        @JsonProperty("phone_number_needs_agreement")
        public Boolean isPhoneNumberAgree;

        //ì „í™”ë²ˆí˜¸
        //êµ­ë‚´ ë²ˆí˜¸ì¸ ê²½ìš° +82 00-0000-0000 í˜•ì‹
        @JsonProperty("phone_number")
        public String phoneNumber;

        //CI ë™ì˜ ì—¬ë¶€
        @JsonProperty("ci_needs_agreement")
        public Boolean isCIAgree;

        //CI, ì—°ê³„ ì •ë³´
        @JsonProperty("ci")
        public String ci;

        //CI ë°œê¸‰ ì‹œê°, UTC
        @JsonProperty("ci_authenticated_at")
        public Date ciCreatedAt;

        @Getter
        @NoArgsConstructor
        @JsonIgnoreProperties(ignoreUnknown = true)
        public class Profile {

            //ë‹‰ë„¤ì„
            @JsonProperty("nickname")
            public String nickName;

            //í”„ë¡œí•„ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ URL
            @JsonProperty("thumbnail_image_url")
            public String thumbnailImageUrl;

            //í”„ë¡œí•„ ì‚¬ì§„ URL
            @JsonProperty("profile_image_url")
            public String profileImageUrl;

            //í”„ë¡œí•„ ì‚¬ì§„ URL ê¸°ë³¸ í”„ë¡œí•„ì¸ì§€ ì—¬ë¶€
            //true : ê¸°ë³¸ í”„ë¡œí•„, false : ì‚¬ìš©ì ë“±ë¡
            @JsonProperty("is_default_image")
            public String isDefaultImage;

            //ë‹‰ë„¤ì„ì´ ê¸°ë³¸ ë‹‰ë„¤ì„ì¸ì§€ ì—¬ë¶€
            //true : ê¸°ë³¸ ë‹‰ë„¤ì„, false : ì‚¬ìš©ì ë“±ë¡
            @JsonProperty("is_default_nickname")
            public Boolean isDefaultNickName;

        }
    }

    @Getter
    @NoArgsConstructor
    @JsonIgnoreProperties(ignoreUnknown = true)
    public class Partner {
        //ê³ ìœ  ID
        @JsonProperty("uuid")
        public String uuid;
    }
}
```

&ensp;KakaoServiceì— ì¶”ê°€í•œë‹¤.
```java
    public KakaoUserInfoResponseDto getUserInfo(String accessToken) {

        KakaoUserInfoResponseDto userInfo = WebClient.create(KAUTH_USER_URL_HOST)
                .get()
                .uri(uriBuilder -> uriBuilder
                        .scheme("https")
                        .path("/v2/user/me")
                        .build(true))
                .header(HttpHeaders.AUTHORIZATION, "Bearer " + accessToken)
                .header(HttpHeaders.CONTENT_TYPE, HttpHeaderValues.APPLICATION_X_WWW_FORM_URLENCODED.toString())
                .retrieve()
                .onStatus(HttpStatusCode::is4xxClientError, clientResponse -> Mono.error(new RuntimeException("Invalid Parameter")))
                .onStatus(HttpStatusCode::is5xxServerError, clientResponse -> Mono.error(new RuntimeException("Internal Server Error")))
                .bodyToMono(KakaoUserInfoResponseDto.class)
                .block();

        log.info(" [Kakao Service] Auth ID ------> {}", userInfo.getId());
        log.info(" [Kakao Service] NickName ------> {}", userInfo.getKakaoAccount().getProfile().getNickName());
        log.info(" [Kakao Service] Id Token ------> {}", userInfo.getKakaoAccount().getProfile().getProfileImageUrl());

        return userInfo;
    }
```

* **https://kapi.kakao.com/v2/user/me**ì— í—¤ë” Authorizationì— Bearer tokenì„ ì¶”ê°€í•´ì„œ GET ìš”ì²­ì„ ë³´ë‚´ë©´, Responseì— ì•„ë˜ì™€ ê°™ì€ Bodyë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.
<p align="center"><img src="/assets/img/BackendProjects/KakaoLogin/5-3-Kakao Developer Get User Info.png"></p>

KakaoLoginController
------

&ensp;ìµœì¢…ì ìœ¼ë¡œ KakaoLoginControllerëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.controller;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto.KakaoUserInfoResponseDto;
import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.service.KakaoService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@Slf4j
@RestController
@RequiredArgsConstructor
@RequestMapping("")
public class KakaoLoginController {

    private final KakaoService kakaoService;

    @GetMapping("/auth/login/kakao")
    public ResponseEntity<?> KakaoLogin(@RequestParam("code") String code) {
        String accessToken = kakaoService.getAccessTokenFromKakao(code);

        KakaoUserInfoResponseDto userInfo = kakaoService.getUserInfo(accessToken);

        // ì—¬ê¸°ì— ì„œë²„ ì‚¬ìš©ì ë¡œê·¸ì¸(ì¸ì¦) ë˜ëŠ” íšŒì›ê°€ì… ë¡œì§ ì¶”ê°€
        return new ResponseEntity<>(HttpStatus.OK);
    }
}
```

íšŒì›ê°€ì…, ë¡œê·¸ì¸
======

&ensp;ë¡œê·¸ì¸ ì´í›„ íšŒì›ê°€ì…ì„ í†µí•´ ì¹´ì¹´ì˜¤ì—ì„œ ì œê³µí•˜ëŠ” ì •ë³´ ì™¸ì— ë‚´ìš©ì„ ë°›ì„ë ¤ê³ í•œë‹¤. ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ Memberë¥¼ ì •ì˜í•´ì¤€ë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.entity;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto.SignupRequestDto;
import jakarta.persistence.*;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Entity
@Table(name="members")
@Getter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Member {

    @Id
    private Long kakaoId;

    private String name;
    private String location;

    @Enumerated(EnumType.STRING)
    private Role role;

    @Column(name = "profile_image_url")
    private String profileImageUrl;

    public enum Role{
        CONSUMER, CORPORATE
    }

    public static Member create(SignupRequestDto dto) {
        return Member.builder()
                .kakaoId(dto.getKakaoId())
                .name(dto.getNickname())
                .location(dto.getLocation())
                .role(Member.Role.valueOf(dto.getRole().toUpperCase()))
                .profileImageUrl(dto.getProfileImageUrl())
                .build();
    }

}
```

&ensp;ë˜í•œ Memberì™€ ê´€ë ¨ëœ ë‚´ìš©ì„ DBì— ì €ì¥í•˜ê¸°ìœ„í•´ MemerReposirotyë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dao;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.entity.Member;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface MemberRepository extends JpaRepository<Member, Long> {
    Optional<Member> findByKakaoId(Long kakaoId);
}
```

* findBykakaoId: kakaoIdë¥¼ í†µí•´ DBì—ì„œ Memberë¥¼ ì°¾ëŠ”ë‹¤.

&ensp; ì´ì œ MemberServiceì™€ MemberServiceImplì„ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.service;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dao.MemberRepository;
import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto.SignupRequestDto;
import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.entity.Member;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
@RequiredArgsConstructor
public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository;

    @Override
    public Member signup(SignupRequestDto dto) {
        return memberRepository.save(Member.create(dto));
    }

    @Override
    public Optional<Member> findByKakaoId(Long kakaoId) {
        return memberRepository.findByKakaoId(kakaoId);
    }

}
```

&ensp;ì´ì œ íšŒì›ê°€ì…ì„ ìœ„í•œ controllerë¥¼ ì‘ì„±í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.controller;

import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.dto.SignupRequestDto;
import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.entity.Member;
import com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.service.MemberService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequiredArgsConstructor
@RequestMapping("/member")
public class MemberController {

    private final MemberService memberService;

    @PostMapping("/signup")
    public ResponseEntity<Member> signup(@RequestBody SignupRequestDto dto) {
        try {
            Member savedMember = memberService.signup(dto);
            return ResponseEntity.ok(savedMember);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(null);
        }
    }
}
```

&ensp;ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ SignupPageControllerë¥¼ ì‘ì„±í•´ Thymleafë¥¼ ì´ìš©í•´ í…ŒìŠ¤íŠ¸í•œë‹¤.
```java
package com.example.seoulpublicdata2025backend.domain.kakaoSocialLogin.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
@RequestMapping("/signup")
public class SignupPageController {

    @GetMapping
    public String signupPage(@RequestParam("kakaoId") Long kakaoId, @RequestParam("profileUrl") String profileUrl, Model model) {
        model.addAttribute("kakaoId", kakaoId);
        model.addAttribute("profileUrl", profileUrl);
        return "signup";
    }
}
```

```html
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì…</title>
</head>
<body>

<h2>ì¶”ê°€ ì •ë³´ ì…ë ¥</h2>

<!-- ğŸ”¥ í”„ë¡œí•„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
<img th:src="${profileUrl}" alt="ì¹´ì¹´ì˜¤ í”„ë¡œí•„ ì´ë¯¸ì§€" width="100" height="100" style="border-radius: 50%; margin-bottom: 10px;">

<form id="signupForm">
    <input type="text" id="nickname" name="nickname" placeholder="ë‹‰ë„¤ì„" required>
    <input type="text" id="location" name="location" placeholder="ê±°ì£¼ì§€" required>

    <select id="role" name="role" required>
        <option value="">ì‚¬ìš©ì ìœ í˜• ì„ íƒ</option>
        <option value="CONSUMER">ì†Œë¹„ì</option>
        <option value="CORPORATE">ê¸°ì—…</option>
    </select>

    <!-- ğŸ”¥ í•„ìˆ˜ ë°ì´í„° (ì¹´ì¹´ì˜¤ IDì™€ í”„ë¡œí•„ ì´ë¯¸ì§€ URL) -->
    <input type="hidden" id="kakaoId" name="kakaoId" th:value="${kakaoId}">
    <input type="hidden" id="profileImageUrl" name="profileImageUrl" th:value="${profileUrl}">

    <button type="submit">ê°€ì…</button>
</form>

<script>
    document.getElementById('signupForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const kakaoId = document.getElementById('kakaoId').value;
        const nickname = document.getElementById('nickname').value;
        const location = document.getElementById('location').value;
        const role = document.getElementById('role').value;
        const profileImageUrl = document.getElementById('profileImageUrl').value;

        const data = {
            kakaoId: kakaoId,
            nickname: nickname,
            location: location,
            role: role,
            profileImageUrl: profileImageUrl
        };

        try {
            const response = await fetch('/member/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                alert('íšŒì›ê°€ì… ì„±ê³µ!');
                window.location.href = '/'; // í•„ìš”ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ìˆ˜ì •
            } else {
                alert('íšŒì›ê°€ì… ì‹¤íŒ¨: ' + response.status);
            }
        } catch (err) {
            console.error('ì—ëŸ¬ ë°œìƒ:', err);
            alert('ì„œë²„ ì˜¤ë¥˜');
        }
    });
</script>

</body>
</html>
```

&ensp;ì´ì œ íšŒì›ê°€ì…ì´ ê°€ëŠ¥í•´ì§€ê³ , ë§Œì•½ íšŒì›ê°€ì…í•œ íšŒì›ì´ë©´ main í˜ì´ì§€ë¡œ ê°€ê²Œëœë‹¤.